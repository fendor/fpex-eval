name: fpex
version: '0.0.0'

extra-source-files:
- package.yaml
- README.md
- stack.yaml

ghc-options: -Wall

default-extensions:
- DeriveGeneric
- GeneralizedNewtypeDeriving
- DerivingStrategies
- DeriveAnyClass
- NamedFieldPuns
- DataKinds
- OverloadedStrings
- ScopedTypeVariables
- RecordWildCards
- LambdaCase
- FlexibleContexts
- FlexibleInstances
- BangPatterns
- TypeOperators
- TypeFamilies
- InstanceSigs
- PatternGuards
- PolyKinds
- TupleSections
- DataKinds
- GADTs
- RankNTypes
- TypeApplications
- NumericUnderscores
- QuasiQuotes

library:
  dependencies:
  - base
  - optparse-applicative
  - extra
  - process
  - text
  - bytestring
  - directory
  - filepath
  - aeson
  - aeson-pretty
  - async
  - unix
  - polysemy
  - polysemy-plugin
  - haskell-src-exts
  - megaparsec
  - regex-tdfa
  source-dirs: src
  ghc-options: -O2 -flate-specialise -fspecialise-aggressively -fplugin=Polysemy.Plugin

executables:
  fpex:
    source-dirs: app
    main: Main.hs
    dependencies:
    - base
    - fpex
    ghc-options:
    - -rtsopts
    - -threaded
    - -with-rtsopts=-N
  fpex-to-json:
    source-dirs: util
    main: DumpTestSpecification.hs
    dependencies:
    - base
    - fpex
    - text
    - aeson
    ghc-options:
    - -rtsopts
    - -threaded
    - -with-rtsopts=-N

tests:
  fpex-test:
    source-dirs: tests
    main: Main.hs
    dependencies:
    - base
    - fpex
    - text
    - tasty
    - tasty-hspec
    - aeson
    - polysemy
    - polysemy-plugin
    ghc-options:
    - -rtsopts
    - -threaded
    - -with-rtsopts=-N
    - -fplugin=Polysemy.Plugin
